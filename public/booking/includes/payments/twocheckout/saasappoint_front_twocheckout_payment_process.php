<?php    	$saasappoint = session_id();	if(empty($saasappoint)) session_start();ob_start();/* Include class files */include(dirname(dirname(dirname(dirname(__FILE__))))."/constants.php");include(dirname(dirname(dirname(dirname(__FILE__))))."/classes/class_connection.php");include(dirname(dirname(dirname(dirname(__FILE__))))."/classes/class_frontend.php");include(dirname(dirname(dirname(dirname(__FILE__))))."/classes/class_settings.php");include("Twocheckout.php");/* Create object of classes */$obj_database = new saasappoint_database();$conn = $obj_database->connect();$obj_frontend = new saasappoint_frontend();$obj_frontend->conn = $conn;$obj_frontend->business_id = $_SESSION['business_id'];$obj_settings = new saasappoint_settings();$obj_settings->conn = $conn;$obj_settings->business_id = $_SESSION['business_id'];$saasappoint_twocheckout_private_key = $obj_settings->get_option("saasappoint_twocheckout_private_key");$saasappoint_twocheckout_seller_id = $obj_settings->get_option("saasappoint_twocheckout_seller_id");$twocc_sandbox_mode = "N";if($twocc_sandbox_mode == 'Y'){	$twocc_sandbox = true;}else{	$twocc_sandbox = false;}Twocheckout::privateKey($saasappoint_twocheckout_private_key); Twocheckout::sellerId($saasappoint_twocheckout_seller_id); Twocheckout::sandbox($twocc_sandbox);/* Twocheckout::verifySSL(false); */$net_total = $_SESSION['saasappoint_cart_nettotal'];$order_id = $obj_frontend->get_order_id();$saasappoint_currency = $obj_settings->get_option('saasappoint_currency');$saasappoint_company_country = $obj_settings->get_option('saasappoint_company_country');try {	$charge = Twocheckout_Charge::auth(array(		"merchantOrderId" => $order_id,		"token"      => $_SESSION['saasappoint_twocheckout_token'],		"currency"   => $saasappoint_currency,		"total"      => $net_total,		"billingAddr" => array(			"name" => ucwords($_SESSION['saasappoint_customer_detail']['firstname'].' '.$_SESSION['saasappoint_customer_detail']['lastname']),			"addrLine1" => $_SESSION['saasappoint_customer_detail']['address'],			"city" => $_SESSION['saasappoint_customer_detail']['city'],			"state" => $_SESSION['saasappoint_customer_detail']['state'],			"zipCode" => $_SESSION['saasappoint_customer_detail']['zip'],			"country" => $saasappoint_company_country,			"email" => $_SESSION['saasappoint_customer_detail']['email'],			"phoneNumber" => $_SESSION['saasappoint_customer_detail']['phone']		)	));		if ($charge['response']['responseCode'] == 'APPROVED') {		$twocheckout_trans_id = $charge['response']['transactionId'];		$_SESSION["transaction_id"] = $twocheckout_trans_id;		$return_response = array ( 'status' => true, 'transaction_id'=>$twocheckout_trans_id);		echo json_encode($return_response);		exit;	}} catch (Twocheckout_Error $e) {	$error = $e->getMessage();	$return_response = array ('status' => false, 'error' => $error);	echo json_encode($return_response);	exit;}